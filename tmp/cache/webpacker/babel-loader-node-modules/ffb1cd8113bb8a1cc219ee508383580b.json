{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/regenerator\";\nvar _jsxFileName = \"/Users/chrisevans/Desktop/github/bucks-adoption/app/javascript/components/ShareDialog/index.jsx\";\n\nfunction asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { Promise.resolve(value).then(_next, _throw); } }\n\nfunction _asyncToGenerator(fn) { return function () { var self = this, args = arguments; return new Promise(function (resolve, reject) { var gen = fn.apply(self, args); function _next(value) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"next\", value); } function _throw(err) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"throw\", err); } _next(undefined); }); }; }\n\nfunction _slicedToArray(arr, i) { return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _nonIterableRest(); }\n\nfunction _nonIterableRest() { throw new TypeError(\"Invalid attempt to destructure non-iterable instance\"); }\n\nfunction _iterableToArrayLimit(arr, i) { var _arr = []; var _n = true; var _d = false; var _e = undefined; try { for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i[\"return\"] != null) _i[\"return\"](); } finally { if (_d) throw _e; } } return _arr; }\n\nfunction _arrayWithHoles(arr) { if (Array.isArray(arr)) return arr; }\n\nimport React, { useState } from \"react\";\nimport { Dialog } from \"@reach/dialog\";\nimport \"@reach/dialog/styles.css\";\nimport \"./style.scss\";\nimport cross from \"./cross.svg\";\nimport fetch from \"isomorphic-unfetch\";\nimport RadioItem from \"./RadioItem\";\nimport Alert from \"../Alert\";\n\nvar ShareDialog = function ShareDialog(_ref) {\n  var dialogIsOpen = _ref.dialogIsOpen,\n      toggleDialog = _ref.toggleDialog,\n      shareableUrl = _ref.shareableUrl,\n      singleService = _ref.singleService;\n\n  var _useState = useState(false),\n      _useState2 = _slicedToArray(_useState, 2),\n      response = _useState2[0],\n      setResponse = _useState2[1];\n\n  var _useState3 = useState(\"\"),\n      _useState4 = _slicedToArray(_useState3, 2),\n      recipient = _useState4[0],\n      changeRecipient = _useState4[1];\n\n  var _useState5 = useState(\"email\"),\n      _useState6 = _slicedToArray(_useState5, 2),\n      medium = _useState6[0],\n      changeMedium = _useState6[1];\n\n  var reset = function reset() {\n    changeRecipient(\"\");\n    changeMedium(\"email\");\n    setResponse(false);\n    toggleDialog(true);\n  };\n\n  var handleSubmit =\n  /*#__PURE__*/\n  function () {\n    var _ref2 = _asyncToGenerator(\n    /*#__PURE__*/\n    _regeneratorRuntime.mark(function _callee(e) {\n      var res;\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              e.preventDefault();\n              _context.prev = 1;\n              _context.next = 4;\n              return fetch(\"/api/share/\".concat(medium), {\n                method: \"post\",\n                headers: {\n                  \"Content-Type\": \"application/json\"\n                },\n                body: JSON.stringify({\n                  url: shareableUrl ? window.location.host + shareableUrl : window.location.href,\n                  email: recipient,\n                  phoneNumber: recipient\n                })\n              });\n\n            case 4:\n              res = _context.sent;\n              setResponse(res.status);\n              _context.next = 11;\n              break;\n\n            case 8:\n              _context.prev = 8;\n              _context.t0 = _context[\"catch\"](1);\n              setResponse(\"fail\");\n\n            case 11:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee, null, [[1, 8]]);\n    }));\n\n    return function handleSubmit(_x) {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n\n  return React.createElement(Dialog, {\n    className: \"share-dialog\",\n    isOpen: dialogIsOpen,\n    onDismiss: function onDismiss() {\n      toggleDialog(false);\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 42\n    },\n    __self: this\n  }, response === 200 ? React.createElement(\"div\", {\n    className: \"share-dialog__body\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 50\n    },\n    __self: this\n  }, React.createElement(\"h2\", {\n    className: \"share-dialog__title\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 51\n    },\n    __self: this\n  }, \"Shared successfully!\"), React.createElement(\"p\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 52\n    },\n    __self: this\n  }, \"Would you like to share with someone else?\"), React.createElement(\"button\", {\n    className: \"inline-button\",\n    onClick: reset,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 53\n    },\n    __self: this\n  }, \"Yes, share again\")) : React.createElement(\"form\", {\n    method: \"post\",\n    action: \"/share/\".concat(medium),\n    onSubmit: handleSubmit,\n    \"aria-live\": \"polite\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 58\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    className: \"share-dialog__body\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 59\n    },\n    __self: this\n  }, React.createElement(\"h2\", {\n    className: \"share-dialog__title\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 60\n    },\n    __self: this\n  }, singleService ? \"Share this service\" : \"Share these recommendations\"), (response === 500 || response === \"fail\") && React.createElement(Alert, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 61\n    },\n    __self: this\n  }, \"There was a problem sharing. If this continues, please try again later\"), response === 404 && React.createElement(Alert, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 62\n    },\n    __self: this\n  }, \"We couldn't share to that \", medium === \"sms\" ? \"phone number\" : \"email\", \". Please check it and try again.\"), React.createElement(\"fieldset\", {\n    className: \"radio-group\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 64\n    },\n    __self: this\n  }, React.createElement(\"p\", {\n    className: \"radio-group-label\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 65\n    },\n    __self: this\n  }, React.createElement(\"legend\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 65\n    },\n    __self: this\n  }, \"Share by:\")), React.createElement(RadioItem, {\n    name: \"medium\",\n    value: \"email\",\n    label: \"Email\",\n    checked: medium,\n    onChange: function onChange() {\n      changeRecipient(\"\");\n      changeMedium(\"email\");\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 66\n    },\n    __self: this\n  }), React.createElement(RadioItem, {\n    name: \"medium\",\n    value: \"sms\",\n    label: \"Text message\",\n    checked: medium,\n    onChange: function onChange() {\n      changeRecipient(\"\");\n      changeMedium(\"sms\");\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 76\n    },\n    __self: this\n  })), React.createElement(\"label\", {\n    className: \"share-dialog__text-label\",\n    htmlFor: \"recipient\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 87\n    },\n    __self: this\n  }, medium === \"sms\" ? \"Phone number\" : \"Email address\", \" \"), React.createElement(\"input\", {\n    type: medium === \"sms\" ? \"tel\" : \"email\",\n    className: \"share-dialog__text-input\",\n    name: \"recipient\",\n    id: \"recipient\",\n    required: true,\n    value: recipient,\n    onChange: function onChange(e) {\n      changeRecipient(e.target.value);\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 88\n    },\n    __self: this\n  })), React.createElement(\"footer\", {\n    className: \"share-dialog__footer\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 100\n    },\n    __self: this\n  }, React.createElement(\"button\", {\n    className: \"share-dialog__action\",\n    type: \"submit\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 101\n    },\n    __self: this\n  }, \"Send \", medium === \"sms\" ? \"message\" : \"email\"))), React.createElement(\"button\", {\n    onClick: function onClick() {\n      toggleDialog(false);\n    },\n    className: \"share__close\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 109\n    },\n    __self: this\n  }, React.createElement(\"img\", {\n    src: cross,\n    alt: \"close share\",\n    className: \"share__close-icon\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 111\n    },\n    __self: this\n  })));\n};\n\nexport default ShareDialog;","map":{"version":3,"sources":["/Users/chrisevans/Desktop/github/bucks-adoption/app/javascript/components/ShareDialog/index.jsx"],"names":["React","useState","Dialog","cross","fetch","RadioItem","Alert","ShareDialog","dialogIsOpen","toggleDialog","shareableUrl","singleService","response","setResponse","recipient","changeRecipient","medium","changeMedium","reset","handleSubmit","e","preventDefault","method","headers","body","JSON","stringify","url","window","location","host","href","email","phoneNumber","res","status","target","value"],"mappings":"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","sourcesContent":["import React, {useState} from \"react\"\nimport { Dialog } from \"@reach/dialog\"\nimport \"@reach/dialog/styles.css\"\nimport \"./style.scss\"\nimport cross from \"./cross.svg\"\nimport fetch from \"isomorphic-unfetch\"\nimport RadioItem from \"./RadioItem\"\nimport Alert from \"../Alert\"\n\nconst ShareDialog = ({dialogIsOpen, toggleDialog, shareableUrl, singleService}) => {\n\n    const [response, setResponse] = useState(false)\n    const [recipient, changeRecipient] = useState(\"\")\n    const [medium, changeMedium] = useState(\"email\")\n\n    const reset = () => {\n        changeRecipient(\"\")\n        changeMedium(\"email\")\n        setResponse(false)\n        toggleDialog(true)\n    }\n\n    const handleSubmit = async (e) => {\n        e.preventDefault()\n        try{\n            const res = await fetch(`/api/share/${medium}`, {\n                method: \"post\",    \n                headers: {\"Content-Type\": \"application/json\"},\n                body: JSON.stringify({ \n                    url: (shareableUrl)? window.location.host + shareableUrl : window.location.href, \n                    email: recipient,\n                    phoneNumber: recipient\n                })\n            })\n            setResponse(res.status)\n        } catch(e){\n            setResponse(\"fail\")\n        }\n    }\n\n    return (\n        <Dialog\n            className=\"share-dialog\"\n            isOpen={dialogIsOpen}\n            onDismiss={()=>{\n                toggleDialog(false)\n            }}\n        >\n            {(response === 200)?\n                <div className=\"share-dialog__body\">\n                    <h2 className=\"share-dialog__title\">Shared successfully!</h2>\n                    <p>Would you like to share with someone else?</p>\n                    <button className=\"inline-button\" onClick={reset}>\n                        Yes, share again\n                    </button>\n                </div>\n                :\n                <form method=\"post\" action={`/share/${medium}`} onSubmit={handleSubmit} aria-live=\"polite\">\n                    <div className=\"share-dialog__body\">\n                        <h2 className=\"share-dialog__title\">{(singleService)? \"Share this service\" : \"Share these recommendations\"}</h2>\n                        {(response === 500 || response === \"fail\") && <Alert>There was a problem sharing. If this continues, please try again later</Alert>}\n                        {(response === 404) && <Alert>We couldn't share to that {(medium === \"sms\")? \"phone number\" : \"email\"}. Please check it and try again.</Alert>}\n\n                        <fieldset className=\"radio-group\">\n                            <p className=\"radio-group-label\"><legend>Share by:</legend></p>\n                            <RadioItem\n                                name=\"medium\"\n                                value=\"email\"\n                                label=\"Email\"\n                                checked={medium}\n                                onChange={()=>{\n                                    changeRecipient(\"\")\n                                    changeMedium(\"email\")\n                                }}\n                            />\n                            <RadioItem\n                                name=\"medium\"\n                                value=\"sms\"\n                                label=\"Text message\"\n                                checked={medium}\n                                onChange={()=>{\n                                    changeRecipient(\"\")\n                                    changeMedium(\"sms\")\n                                }}\n                            />\n                        </fieldset>\n                        <label className=\"share-dialog__text-label\" htmlFor=\"recipient\">{(medium === \"sms\")? \"Phone number\" : \"Email address\"} </label>\n                        <input \n                            type={(medium === \"sms\")? \"tel\" : \"email\"} \n                            className=\"share-dialog__text-input\"\n                            name=\"recipient\"\n                            id=\"recipient\"\n                            required\n                            value={recipient}\n                            onChange={(e)=>{\n                                changeRecipient(e.target.value)\n                            }}\n                        />\n                    </div>\n                    <footer className=\"share-dialog__footer\">\n                        <button className=\"share-dialog__action\" \n                            type=\"submit\" \n                        >\n                            Send {(medium === \"sms\")? \"message\" : \"email\"}\n                        </button>\n                    </footer>\n                </form>\n            }\n            <button onClick={()=>{\n                toggleDialog(false)\n            }} className=\"share__close\"><img src={cross} alt=\"close share\" className=\"share__close-icon\"/></button>\n        </Dialog>\n    )\n}\n\nexport default ShareDialog"]},"metadata":{},"sourceType":"module"}