{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/regenerator\";\nvar _jsxFileName = \"/Users/chrisevans/Desktop/github/bucks-adoption/app/javascript/components/NeedsExplorerQuestions/index.jsx\";\n\nfunction asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { Promise.resolve(value).then(_next, _throw); } }\n\nfunction _asyncToGenerator(fn) { return function () { var self = this, args = arguments; return new Promise(function (resolve, reject) { var gen = fn.apply(self, args); function _next(value) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"next\", value); } function _throw(err) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"throw\", err); } _next(undefined); }); }; }\n\nfunction _toConsumableArray(arr) { return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _nonIterableSpread(); }\n\nfunction _nonIterableSpread() { throw new TypeError(\"Invalid attempt to spread non-iterable instance\"); }\n\nfunction _iterableToArray(iter) { if (Symbol.iterator in Object(iter) || Object.prototype.toString.call(iter) === \"[object Arguments]\") return Array.from(iter); }\n\nfunction _arrayWithoutHoles(arr) { if (Array.isArray(arr)) { for (var i = 0, arr2 = new Array(arr.length); i < arr.length; i++) { arr2[i] = arr[i]; } return arr2; } }\n\nfunction _slicedToArray(arr, i) { return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _nonIterableRest(); }\n\nfunction _nonIterableRest() { throw new TypeError(\"Invalid attempt to destructure non-iterable instance\"); }\n\nfunction _iterableToArrayLimit(arr, i) { var _arr = []; var _n = true; var _d = false; var _e = undefined; try { for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i[\"return\"] != null) _i[\"return\"](); } finally { if (_d) throw _e; } } return _arr; }\n\nfunction _arrayWithHoles(arr) { if (Array.isArray(arr)) return arr; }\n\nimport React, { useState, useEffect } from \"react\";\nimport \"./style.scss\";\nimport Button from \"../Button\";\nimport queryString from \"query-string\";\nimport Router from \"next/router\";\nimport geocode from \"../../lib/geocode-client\";\nimport CategoryQuestion from \"./CategoryQuestion\";\nimport KeywordQuestion from \"./KeywordQuestion\";\nimport LocationQuestion from \"./LocationQuestion\";\nimport AgeQuestion from \"./AgeQuestion\";\n\nvar NeedsExplorerQuestions = function NeedsExplorerQuestions() {\n  var _useState = useState(false),\n      _useState2 = _slicedToArray(_useState, 2),\n      scrolled = _useState2[0],\n      setScrolled = _useState2[1];\n\n  var controlScroll = function controlScroll() {\n    if (window.scrollY === 0) {\n      setScrolled(false);\n    } else {\n      setScrolled(true);\n    }\n  };\n\n  useEffect(function () {\n    controlScroll();\n    window.addEventListener(\"scroll\", controlScroll);\n  }, []);\n\n  var _useState3 = useState([]),\n      _useState4 = _slicedToArray(_useState3, 2),\n      categorySelection = _useState4[0],\n      changeCategorySelection = _useState4[1];\n\n  var handleCategoryChange = function handleCategoryChange(e) {\n    var _e$target = e.target,\n        checked = _e$target.checked,\n        value = _e$target.value; // Clear out keywords whenever the support category is hit\n\n    if (value === \"support\") changeKeywordSelection([]);\n\n    if (checked) {\n      changeCategorySelection([].concat(_toConsumableArray(categorySelection), [value]));\n    } else {\n      changeCategorySelection(categorySelection.filter(function (selection) {\n        return selection != value;\n      }));\n    }\n  };\n\n  var _useState5 = useState([]),\n      _useState6 = _slicedToArray(_useState5, 2),\n      keywordSelection = _useState6[0],\n      changeKeywordSelection = _useState6[1];\n\n  var handleKeywordChange = function handleKeywordChange(e) {\n    var _e$target2 = e.target,\n        checked = _e$target2.checked,\n        value = _e$target2.value;\n\n    if (checked) {\n      changeKeywordSelection([].concat(_toConsumableArray(keywordSelection), [value]));\n    } else {\n      changeKeywordSelection(keywordSelection.filter(function (selection) {\n        return selection != value;\n      }));\n    }\n  };\n\n  var _useState7 = useState([]),\n      _useState8 = _slicedToArray(_useState7, 2),\n      ageSelection = _useState8[0],\n      changeAgeSelection = _useState8[1];\n\n  var handleAgeChange = function handleAgeChange(e) {\n    changeAgeSelection([e.target.value]);\n  };\n\n  var _useState9 = useState(\"\"),\n      _useState10 = _slicedToArray(_useState9, 2),\n      rawLocation = _useState10[0],\n      changeRawLocation = _useState10[1];\n\n  var _useState11 = useState(\"\"),\n      _useState12 = _slicedToArray(_useState11, 2),\n      formattedLocation = _useState12[0],\n      changeFormattedLocation = _useState12[1];\n\n  var handleRawLocationChange = function handleRawLocationChange(e) {\n    changeRawLocation(e.target.value);\n    if (!e.target.value) changeFormattedLocation(false);\n  };\n\n  var handleBlur =\n  /*#__PURE__*/\n  function () {\n    var _ref = _asyncToGenerator(\n    /*#__PURE__*/\n    _regeneratorRuntime.mark(function _callee(e) {\n      var location;\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              if (!e.target.value) {\n                _context.next = 5;\n                break;\n              }\n\n              _context.next = 3;\n              return geocode(rawLocation);\n\n            case 3:\n              location = _context.sent;\n              changeFormattedLocation(location.formattedLocation);\n\n            case 5:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }));\n\n    return function handleBlur(_x) {\n      return _ref.apply(this, arguments);\n    };\n  }();\n\n  var handleSubmit =\n  /*#__PURE__*/\n  function () {\n    var _ref2 = _asyncToGenerator(\n    /*#__PURE__*/\n    _regeneratorRuntime.mark(function _callee2(e) {\n      var geocoded, query;\n      return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              e.preventDefault();\n              _context2.next = 3;\n              return geocode(rawLocation);\n\n            case 3:\n              geocoded = _context2.sent;\n              query = {\n                category: categorySelection,\n                keywords: keywordSelection,\n                location: rawLocation,\n                formattedLocation: geocoded.formattedLocation,\n                age: ageSelection,\n                lat: geocoded.lat,\n                lng: geocoded.lng\n              };\n              Router.push(\"/recommendations?\".concat(queryString.stringify(query))).then(function () {\n                return window.scrollTo(0, 0);\n              });\n\n            case 6:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee2);\n    }));\n\n    return function handleSubmit(_x2) {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n\n  return React.createElement(\"form\", {\n    method: \"get\",\n    action: \"/recommendations\",\n    onSubmit: handleSubmit,\n    \"aria-live\": \"polite\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 91\n    },\n    __self: this\n  }, React.createElement(\"section\", {\n    className: \"questions\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 92\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    className: \"questions__inner\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 93\n    },\n    __self: this\n  }, React.createElement(CategoryQuestion, {\n    selection: categorySelection,\n    onChange: handleCategoryChange,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 95\n    },\n    __self: this\n  }), categorySelection.includes(\"support\") && React.createElement(KeywordQuestion, {\n    onChange: handleKeywordChange,\n    selection: keywordSelection,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 100\n    },\n    __self: this\n  }), React.createElement(AgeQuestion, {\n    onChange: handleAgeChange,\n    selection: ageSelection,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 106\n    },\n    __self: this\n  }), React.createElement(LocationQuestion, {\n    rawLocation: rawLocation,\n    formattedLocation: formattedLocation,\n    onChange: handleRawLocationChange,\n    onBlur: handleBlur,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 111\n    },\n    __self: this\n  }))), React.createElement(\"div\", {\n    className: scrolled ? \"continue-to-recommendations continue-to-recommendations--visible\" : \"continue-to-recommendations\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 119\n    },\n    __self: this\n  }, React.createElement(ContinueToRecommendations, {\n    keywordSelection: keywordSelection,\n    ageSelection: ageSelection,\n    categorySelection: categorySelection,\n    rawLocation: rawLocation,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 120\n    },\n    __self: this\n  })));\n};\n\nexport default NeedsExplorerQuestions;\n\nvar ContinueToRecommendations = function ContinueToRecommendations(_ref3) {\n  var categorySelection = _ref3.categorySelection,\n      keywordSelection = _ref3.keywordSelection,\n      ageSelection = _ref3.ageSelection,\n      rawLocation = _ref3.rawLocation;\n\n  if ((categorySelection.length > 0 || keywordSelection.length > 0 || ageSelection.length > 0) && rawLocation) {\n    return React.createElement(React.Fragment, null, React.createElement(Button, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 138\n      },\n      __self: this\n    }, \"Go to recommendations\"));\n  } else if (categorySelection.length > 0 || keywordSelection.length > 0 || ageSelection.length > 0) {\n    return React.createElement(React.Fragment, null, React.createElement(\"p\", {\n      className: \"continue-to-recommendations__message\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 144\n      },\n      __self: this\n    }, \"Give a location to see your recommendations\"), React.createElement(Button, {\n      disabled: true,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 145\n      },\n      __self: this\n    }, \"Go to recommendations\"));\n  } else {\n    return React.createElement(React.Fragment, null, React.createElement(\"p\", {\n      className: \"continue-to-recommendations__message\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 151\n      },\n      __self: this\n    }, \"Answer more questions to see your recommendations\"), React.createElement(Button, {\n      disabled: true,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 152\n      },\n      __self: this\n    }, \"Go to recommendations\"));\n  }\n};","map":{"version":3,"sources":["/Users/chrisevans/Desktop/github/bucks-adoption/app/javascript/components/NeedsExplorerQuestions/index.jsx"],"names":["React","useState","useEffect","Button","queryString","Router","geocode","CategoryQuestion","KeywordQuestion","LocationQuestion","AgeQuestion","NeedsExplorerQuestions","scrolled","setScrolled","controlScroll","window","scrollY","addEventListener","categorySelection","changeCategorySelection","handleCategoryChange","e","target","checked","value","changeKeywordSelection","filter","selection","keywordSelection","handleKeywordChange","ageSelection","changeAgeSelection","handleAgeChange","rawLocation","changeRawLocation","formattedLocation","changeFormattedLocation","handleRawLocationChange","handleBlur","location","handleSubmit","preventDefault","geocoded","query","category","keywords","age","lat","lng","push","stringify","then","scrollTo","includes","ContinueToRecommendations","length"],"mappings":"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","sourcesContent":["import React, {useState, useEffect} from \"react\"\nimport \"./style.scss\"\nimport Button from \"../Button\"\nimport queryString from \"query-string\"\nimport Router from \"next/router\"\nimport geocode from \"../../lib/geocode-client\"\n\nimport CategoryQuestion from \"./CategoryQuestion\"\nimport KeywordQuestion from \"./KeywordQuestion\"\nimport LocationQuestion from \"./LocationQuestion\"\nimport AgeQuestion from \"./AgeQuestion\"\n\nconst NeedsExplorerQuestions = () => {\n\n    const [scrolled, setScrolled] = useState(false)\n\n    const controlScroll = ()=>{\n        if(window.scrollY === 0){\n            setScrolled(false)\n        } else {\n            setScrolled(true)\n        }\n    }\n\n    useEffect(()=>{\n        controlScroll()\n        window.addEventListener(\"scroll\", controlScroll)\n    }, [])\n\n    const [categorySelection, changeCategorySelection] = useState([])\n    const handleCategoryChange = (e) => {\n        let {checked, value} = e.target\n        // Clear out keywords whenever the support category is hit\n        if(value === \"support\") changeKeywordSelection([])\n        if(checked){\n            changeCategorySelection([...categorySelection, value])\n        } else {\n            changeCategorySelection(categorySelection.filter(selection=>{\n                return selection != value\n            }))\n        }\n    }\n\n    const [keywordSelection, changeKeywordSelection] = useState([])\n    const handleKeywordChange = (e) => {\n        let {checked, value} = e.target\n        if(checked){\n            changeKeywordSelection([...keywordSelection, value])\n        } else {\n            changeKeywordSelection(keywordSelection.filter(selection=>{\n                return selection != value\n            }))\n        }\n    }\n\n    const [ageSelection, changeAgeSelection] = useState([])\n    const handleAgeChange = (e) => {\n        changeAgeSelection([e.target.value])\n    }\n\n    const [rawLocation, changeRawLocation] = useState(\"\")\n    const [formattedLocation, changeFormattedLocation] = useState(\"\")\n    const handleRawLocationChange = (e) => {\n        changeRawLocation(e.target.value)\n        if(!e.target.value) changeFormattedLocation(false)\n    }\n\n    const handleBlur = async (e) => {\n        if(e.target.value){\n            let location = await geocode(rawLocation)\n            changeFormattedLocation(location.formattedLocation)\n        }\n    }\n\n    const handleSubmit = async (e) => {\n        e.preventDefault()\n        let geocoded = await geocode(rawLocation)\n        let query = {\n            category: categorySelection,\n            keywords: keywordSelection,\n            location: rawLocation,\n            formattedLocation: geocoded.formattedLocation,\n            age: ageSelection,\n            lat: geocoded.lat,\n            lng: geocoded.lng\n        }\n        Router.push(`/recommendations?${queryString.stringify(query)}`).then(() => window.scrollTo(0, 0))\n    }\n\n    return(\n        <form method=\"get\" action=\"/recommendations\" onSubmit={handleSubmit} aria-live=\"polite\">\n            <section className=\"questions\">\n                <div className=\"questions__inner\">\n\n                    <CategoryQuestion \n                        selection={categorySelection} \n                        onChange={handleCategoryChange}\n                    />\n                    {categorySelection.includes(\"support\") && \n                        <KeywordQuestion \n                            onChange={handleKeywordChange} \n                            selection={keywordSelection}\n                        />\n                    }\n\n                    <AgeQuestion \n                        onChange={handleAgeChange} \n                        selection={ageSelection}\n                    />\n\n                    <LocationQuestion \n                        rawLocation={rawLocation} \n                        formattedLocation={formattedLocation} \n                        onChange={handleRawLocationChange} \n                        onBlur={handleBlur}\n                    />\n                </div>\n            </section>\n            <div className={(scrolled)? \"continue-to-recommendations continue-to-recommendations--visible\":\"continue-to-recommendations\"}>\n                <ContinueToRecommendations\n                    keywordSelection={keywordSelection}\n                    ageSelection={ageSelection}\n                    categorySelection={categorySelection}\n                    rawLocation={rawLocation}\n                />\n            </div>\n        </form>\n        \n    )\n}\n\nexport default NeedsExplorerQuestions\n\nconst ContinueToRecommendations= ({categorySelection, keywordSelection, ageSelection, rawLocation}) => {\n    if ((categorySelection.length > 0 || keywordSelection.length > 0 || ageSelection.length > 0) && rawLocation){\n        return(\n            <>\n                <Button>Go to recommendations</Button>\n            </>\n        )\n    } else if (categorySelection.length > 0 || keywordSelection.length > 0 || ageSelection.length > 0){\n        return(\n            <>\n                <p className=\"continue-to-recommendations__message\">Give a location to see your recommendations</p>\n                <Button disabled>Go to recommendations</Button>\n            </>\n        )\n    } else {\n        return(\n            <>\n                <p className=\"continue-to-recommendations__message\">Answer more questions to see your recommendations</p>\n                <Button disabled>Go to recommendations</Button>\n            </>\n        )\n    }\n}\n"]},"metadata":{},"sourceType":"module"}