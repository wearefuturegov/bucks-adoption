{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/regenerator\";\nvar _jsxFileName = \"/Users/chrisevans/Desktop/github/bucks-adoption/app/javascript/components/Filter/LocationFilter.jsx\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(source, true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(source).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nfunction asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { Promise.resolve(value).then(_next, _throw); } }\n\nfunction _asyncToGenerator(fn) { return function () { var self = this, args = arguments; return new Promise(function (resolve, reject) { var gen = fn.apply(self, args); function _next(value) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"next\", value); } function _throw(err) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"throw\", err); } _next(undefined); }); }; }\n\nfunction _slicedToArray(arr, i) { return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _nonIterableRest(); }\n\nfunction _nonIterableRest() { throw new TypeError(\"Invalid attempt to destructure non-iterable instance\"); }\n\nfunction _iterableToArrayLimit(arr, i) { var _arr = []; var _n = true; var _d = false; var _e = undefined; try { for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i[\"return\"] != null) _i[\"return\"](); } finally { if (_d) throw _e; } } return _arr; }\n\nfunction _arrayWithHoles(arr) { if (Array.isArray(arr)) return arr; }\n\nimport React, { useState, useEffect } from \"react\";\nimport PropTypes from \"prop-types\";\nimport { Dialog } from \"@reach/dialog\";\nimport \"@reach/dialog/styles.css\";\nimport \"./style.scss\";\nimport Router from \"next/router\";\nimport geocode from \"../../lib/geocode-client\";\nimport cross from \"./cross.svg\"; // State moved up into parent component so that alert bar can trigger dialog\n\nvar LocationFilter = function LocationFilter(_ref) {\n  var dialogIsOpen = _ref.dialogIsOpen,\n      toggleDialog = _ref.toggleDialog;\n\n  var _useState = useState(\"\"),\n      _useState2 = _slicedToArray(_useState, 2),\n      location = _useState2[0],\n      changeLocation = _useState2[1];\n\n  useEffect(function () {\n    Router.query.location && changeLocation(Router.query.location);\n  }, dialogIsOpen);\n\n  var updateResults =\n  /*#__PURE__*/\n  function () {\n    var _ref2 = _asyncToGenerator(\n    /*#__PURE__*/\n    _regeneratorRuntime.mark(function _callee(e) {\n      var newLocation;\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              if (e) e.preventDefault();\n              toggleDialog(false);\n\n              if (!location) {\n                _context.next = 7;\n                break;\n              }\n\n              _context.next = 5;\n              return geocode(location);\n\n            case 5:\n              newLocation = _context.sent;\n              Router.push({\n                pathname: Router.pathname,\n                query: _objectSpread({}, Router.query, {\n                  location: location,\n                  lat: newLocation.lat,\n                  lng: newLocation.lng,\n                  formattedLocation: newLocation.formattedLocation\n                })\n              });\n\n            case 7:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }));\n\n    return function updateResults(_x) {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n\n  var clearFilter = function clearFilter(e) {\n    if (e) e.preventDefault();\n    changeLocation(\"\");\n  };\n\n  return React.createElement(React.Fragment, null, React.createElement(\"button\", {\n    className: location ? \"filter-button filter-button--active\" : \"filter-button\",\n    onClick: function onClick() {\n      toggleDialog(true);\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 44\n    },\n    __self: this\n  }, \"Location\"), React.createElement(Dialog, {\n    className: \"filter-dialog\",\n    isOpen: dialogIsOpen,\n    onDismiss: updateResults,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 51\n    },\n    __self: this\n  }, React.createElement(\"form\", {\n    method: \"get\",\n    action: \"/recommendations\",\n    onSubmit: updateResults,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 57\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    className: \"filter-dialog__body\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 58\n    },\n    __self: this\n  }, React.createElement(\"h2\", {\n    className: \"filter-dialog__title\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 59\n    },\n    __self: this\n  }, \"Near you\"), React.createElement(\"label\", {\n    className: \"filter-dialog__text-label\",\n    htmlFor: \"location\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 62\n    },\n    __self: this\n  }, \"Town or postcode in Buckinghamshire\"), React.createElement(\"input\", {\n    type: \"text\",\n    className: \"filter-dialog__text-input\",\n    name: \"location\",\n    id: \"location\",\n    value: location,\n    onChange: function onChange(e) {\n      changeLocation(e.target.value);\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 63\n    },\n    __self: this\n  })), React.createElement(\"footer\", {\n    className: \"filter-dialog__footer\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 75\n    },\n    __self: this\n  }, React.createElement(\"button\", {\n    className: \"filter-dialog__action\",\n    type: \"submit\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 76\n    },\n    __self: this\n  }, \"Apply\"), React.createElement(\"button\", {\n    className: \"filter-dialog__action filter-dialog__action--secondary\",\n    onClick: clearFilter,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 81\n    },\n    __self: this\n  }, \"Clear\"))), React.createElement(\"button\", {\n    onClick: function onClick() {\n      toggleDialog(false);\n    },\n    className: \"filter__close\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 84\n    },\n    __self: this\n  }, React.createElement(\"img\", {\n    src: cross,\n    alt: \"close filter\",\n    className: \"filter__close-icon\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 86\n    },\n    __self: this\n  }))));\n};\n\nLocationFilter.propTypes = {\n  dialogIsOpen: PropTypes.bool.isRequired,\n  toggleDialog: PropTypes.func.isRequired\n};\nexport default LocationFilter;","map":{"version":3,"sources":["/Users/chrisevans/Desktop/github/bucks-adoption/app/javascript/components/Filter/LocationFilter.jsx"],"names":["React","useState","useEffect","PropTypes","Dialog","Router","geocode","cross","LocationFilter","dialogIsOpen","toggleDialog","location","changeLocation","query","updateResults","e","preventDefault","newLocation","push","pathname","lat","lng","formattedLocation","clearFilter","target","value","propTypes","bool","isRequired","func"],"mappings":"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","sourcesContent":["import React, {useState, useEffect} from \"react\"\nimport PropTypes from \"prop-types\"\nimport { Dialog } from \"@reach/dialog\"\nimport \"@reach/dialog/styles.css\"\nimport \"./style.scss\"\nimport Router from \"next/router\"\nimport geocode from \"../../lib/geocode-client\"\nimport cross from \"./cross.svg\"\n\n// State moved up into parent component so that alert bar can trigger dialog\nconst LocationFilter = ({dialogIsOpen, toggleDialog}) => {\n\n    const [location, changeLocation] = useState(\"\")\n    \n    useEffect(()=>{\n        Router.query.location && changeLocation(Router.query.location)\n    }, dialogIsOpen)\n\n    const updateResults = async (e) => {\n        if(e) e.preventDefault()\n        toggleDialog(false)\n        if(location){\n            let newLocation = await geocode(location)\n            Router.push({\n                pathname: Router.pathname,\n                query: {\n                    ...Router.query,\n                    location: location,\n                    lat: newLocation.lat,\n                    lng: newLocation.lng,\n                    formattedLocation: newLocation.formattedLocation\n                }\n            })\n        }\n    }\n\n    const clearFilter = (e) =>{\n        if(e) e.preventDefault()\n        changeLocation(\"\")\n    }\n\n    return (\n        <>\n            <button \n                className={(location)? \"filter-button filter-button--active\" : \"filter-button\"}\n                onClick={() => {toggleDialog(true)}}\n            >\n                Location\n            </button>\n\n            <Dialog\n                className=\"filter-dialog\"\n                isOpen={dialogIsOpen}\n                onDismiss={updateResults}\n            >\n\n                <form method=\"get\" action=\"/recommendations\" onSubmit={updateResults}>\n                    <div className=\"filter-dialog__body\">\n                        <h2 className=\"filter-dialog__title\">Near you</h2>\n\n\n                        <label className=\"filter-dialog__text-label\" htmlFor=\"location\">Town or postcode in Buckinghamshire</label>\n                        <input \n                            type=\"text\" \n                            className=\"filter-dialog__text-input\"\n                            name=\"location\"\n                            id=\"location\"\n                            value={location}\n                            onChange={(e)=>{\n                                changeLocation(e.target.value)\n                            }}\n                        />\n                    </div>\n\n                    <footer className=\"filter-dialog__footer\">\n                        <button className=\"filter-dialog__action\" \n                            type=\"submit\" \n                        >\n                                Apply\n                        </button>\n                        <button className=\"filter-dialog__action filter-dialog__action--secondary\" onClick={clearFilter}>Clear</button>\n                    </footer>\n                </form>\n                <button onClick={()=>{\n                    toggleDialog(false)\n                }} className=\"filter__close\"><img src={cross} alt=\"close filter\" className=\"filter__close-icon\"/></button>\n            </Dialog>\n            \n        </>\n    )\n}\n\nLocationFilter.propTypes = {\n    dialogIsOpen: PropTypes.bool.isRequired,\n    toggleDialog: PropTypes.func.isRequired\n}\n\nexport default LocationFilter"]},"metadata":{},"sourceType":"module"}